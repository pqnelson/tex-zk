\ProvidesPackage{sml}[2023/12/19 Standard ML Syntax Highlighting]

\RequirePackage{listings}
\RequirePackage{xcolor}


% https://github.com/jez/latex-solarized
% Solarized colors
\definecolor{sbase03}{HTML}{002B36}
\definecolor{sbase02}{HTML}{073642}
\definecolor{sbase01}{HTML}{586E75}
\definecolor{sbase00}{HTML}{657B83}
\definecolor{sbase0}{HTML}{839496}
\definecolor{sbase1}{HTML}{93A1A1}
\definecolor{sbase2}{HTML}{EEE8D5}
\definecolor{sbase3}{HTML}{FDF6E3}
\definecolor{syellow}{HTML}{B58900}
\definecolor{sorange}{HTML}{CB4B16}
\definecolor{sred}{HTML}{DC322F}
\definecolor{smagenta}{HTML}{D33682}
\definecolor{sviolet}{HTML}{6C71C4}
\definecolor{sblue}{HTML}{268BD2}
\definecolor{scyan}{HTML}{2AA198}
\definecolor{sgreen}{HTML}{859900}

\definecolor{gray}{rgb}{0.5,0.5,0.5}
%\definecolor{ghBlue}{HTML}{0550ae} % rgb(5, 80, 174)
\definecolor{ghBlue}{HTML}{2075c7}
%\definecolor{ghPurple}{HTML}{8250df} % rbg(130, 80, 223)
\definecolor{ghPurple}{HTML}{c61b6e}
\definecolor{ghRed}{HTML}{cf222e}  % rbg(207, 34, 46)
\definecolor{ghRed2}{HTML}{953800}  % rgb(149, 56, 0)
% orange from https://github.com/sellout/emacs-color-theme-solarized
%\definecolor{solOrange}{HTML}{cb4b16}%{bd3612}%{fb7640}
%\definecolor{bgcolor}{HTML}{073642} % solarized-dark
% \definecolor{bgcolor}{HTML}{eee8d5} % solarized light
\definecolor{bgcolor}{HTML}{FDF6E3}%{eee8d5} % solarized light
%\definecolor{bgcolor}{HTML}{eee8d5} % solarized light
%\definecolor{base3}{HTML}{fcf4dc} % solarized-dark
\definecolor{base3}{HTML}{002b36} % solarized light
%\definecolor{solarizedGreenHc}{HTML}{
\definecolor{solarizedGreen}{HTML}{859900}
\definecolor{solarizedPurple}{HTML}{ff699e}%{c47896}%{cc6791}%{d33682}
\definecolor{solarizedBlue}{HTML}{268bd2}
\definecolor{stringblue}{HTML}{032f62}
\def\defaultCommentStyle{\color{gray}}
\def\mizarDefaultStyle{}
\def\mizarFormulaStyle{\color{smagenta}}%{\color{ghPurple}}%{\color{solarizedPurple}}
\def\mizarKWStyle{\color{sblue}}%{\color{solarizedBlue}}
\def\mizarProofKWStyle{\color{sgreen}}%{\color{scyan}}%{\color{solarizedGreen}}
\def\SMLkwd{\color{ghRed}}
\def\SMLtype{}
\def\SMLconst{\color{ghBlue}}

\lstdefinelanguage{SML}%
{
  sensitive,
  morekeywords=[0]{abstype,and,andalso,as,case,do,datatype,else,end,%
       exception,fn,fun,handle,if,in,infix,%
       infixr,let,local,nonfix,of,op,open,orelse,raise,rec,%
       then,type,val,with,withtype,while},%
  morekeywords=[1]{eqtype,functor,include,sharing,sig,signature,struct,structure,where},%
  morekeywords=[2]{bool,char,int,real,string,unit},%
  morekeywords=[3]{false,nil,true,NONE,SOME},%
  keywordstyle=[0]{\SMLkwd},%
  keywordstyle=[1]{\SMLkwd},%
  keywordstyle=[2]{\SMLtype},%
  keywordstyle=[3]{\SMLconst},%
  morecomment=[n]{(*}{*)},%
  columns=flexible,%
  commentstyle={\SMLcomment},%\slshape\defaultCommentStyle},%
  stringstyle={\color{stringblue}},%
  morestring=[d]"%
  }

\RequirePackage{mdframed}
\mdfsetup{skipabove=\smallskipamount,%\medskipamount,
  skipbelow=\smallskipamount,%\medskipamount,
  outermargin=-1em,
  innermargin=-1em,
  leftmargin=0pt,
  rightmargin=0pt,
  innerleftmargin=0em,
  innerrightmargin=0pt,
  rightline=false,
  leftline=false,
  frametitlerule=true,
  innertopmargin=0pt,%\smallskipamount,%\topsep,
  innerbottommargin=1pt,%\smallskipamount,%\topsep,
  splittopskip=\smallskipamount}%\topsep}
\lstnewenvironment{sml}%
                  {\smallbreak\mdframed[backgroundcolor=bgcolor]
                   %\mdframed[backgroundcolor=bgcolor,outerlinewidth=1pt]
                    \lstset{language=SML,
                      basicstyle=\color{sbase03}\ttfamily\small,
%                      basicstyle=\ttfamily\small,
                      upquote=true}}%
                  {\endmdframed}%\smallbreak}
\endinput